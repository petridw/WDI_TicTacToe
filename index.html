<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- fonts -->
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Nunito' rel='stylesheet' type='text/css'>

    <!-- firebase and angular -->
    <script src='https://cdn.firebase.com/js/client/2.0.4/firebase.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>

    <!--angular fire (must be last) -->
    <script src="https://cdn.firebase.com/libs/angularfire/0.9.0/angularfire.min.js"></script>

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
    
    <!-- my stylesheets -->
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/animations.css">

  <!--   <script src="js/app.js"></script>-->
    <script src="js/GameController.js"></script>

    <title>tic tac whaaat</title>
  </head>


<body ng-app="ticTacToeApp">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>


  <div class="main" ng-controller="GameController as vm">

    <div id="wrapper" ng-class="{ 'hide-chat': vm.hideChat, 'hide-lobbies': vm.hideLobbies }">

      <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - RIGHT SIDEBAR - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - - messages - - - - - - - - - - - - -->

      <div id="right-sidebar-wrapper">

        <div class="messages">
<!--           <div class="message-color-picker-container">
            <input type="color" class="message-color-picker" value="#FF4242" ng-model="vm.messageColor" ng-change="vm.setMessageColor()">
          </div> -->
          <div class="message-header-container">
            <p ng-show="vm.playerName === ''">Welcome to the chat! Before you can chat or play, you need to enter your name in the Setup section</p>
            <h3 ng-show="vm.playerName !== ''" class="message-player-hello">Hello, {{vm.playerName}}!</h3>
          </div>

          <div class="message-list-container">

            <p class="chat-welcome" ng-show="(vm.currentGame.messages.length === 0)">Welcome to the chat...</p>
            <ul class="message-list" ng-show="(vm.currentGame.messages.length > 0)" >
              <li class="message" ng-repeat="message in vm.currentGame.messages">
                <span ng-show="message.content.length > 0"><span class="message-name" ng-style="{color: vm.messageColor}">{{ message.name }}</span>: {{ message.content }}</span>
              </li>
            </ul>
          </div>

          <div class="message-form-container">
            <form>
              <input class="message-input" type="text" ng-model="vm.newMessage" placeholder="Send a message">
              <button type="submit" class="btn btn-default"
                                    ng-class="{ disabled: ((vm.playerName.length < 1) ||
                                                           (vm.newMessage.length < 1)) }"
                                    ng-click="vm.sendMessage()">
                <span class="glyphicon glyphicon-comment"></span>
              </button>
            </form>
          </div>
        </div>

      </div>

      <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - LEFT SIDEBAR - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - - Lobbies - - - - - - - - - - - - -->
      <div id="left-sidebar-wrapper">
        <div class="lobbies">
          <h3>Lobbies</h3>
          <div class="lobby-search">
            <input type="text" ng-model="vm.lobbySearch" placeholder="Search lobbies...">
          </div>
          <div class="lobbies-list-container">
            <ul>
              <li ng-repeat="game in vm.games | orderBy:'time':true | filter:vm.lobbySearch | limitTo: 100">
                <div class="lobby" ng-class="{'current-lobby': game.$id == vm.currentGame.$id}">

                  <a href="#" ng-click="vm.setCurrentGame(game.$id)"><span class="link"></span></a>

                  <div class="lobby-section">
                    <span class="lobby-info">
                      {{ (game.player1.length > 0) ? game.player1 : '?' }} vs. {{ (game.player2.length > 0) ? game.player2 : '?' }}
                    </span>
                  </div>
                  <div class="lobby-section">
                    <span class="lobby-info" ng-show="!game.postGame && !game.gameInProgress">Not started</span>
                    <span class="lobby-info" ng-show="game.gameInProgress">In progress</span>
                    <span class="lobby-info" ng-show="game.postGame">{{ game.winner }}</span>
                  </div>
                  <div class="lobby-section">
                    <span class="lobby-info" class="game-time">{{ game.time | date:'short' }}</span>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>


      <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - main content - - - - - - - - - - - -->
      <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

      <div class="container-fluid">

        <div class="row">
          <div class="col-md-12">
            <div class="collapse-buttons-wrapper">
              <div class="collapse-lobbies-wrapper">
                <a href="#" ng-click="vm.hideLobbies = !vm.hideLobbies">
                  <span class="glyphicon" ng-class="{ 'glyphicon-chevron-left': !vm.hideLobbies, 'glyphicon-chevron-right': vm.hideLobbies }"></span>
                 </a>
              </div>
              <div class="collapse-chat-wrapper">
                <a href="#" id="menu-toggle" ng-click="vm.hideChat = !vm.hideChat">
                  <span class="glyphicon" 
                        ng-class="{ 'glyphicon-chevron-left': vm.hideChat, 'glyphicon-chevron-right': !vm.hideChat }">
                  </span>
                </a>
              </div>
            </div>
          </div>
        </div>

        <span class="clear"></span>

        <div class="row">
          <div class="col-md-12 logo">
            <h1>tic tac toe</h1>
          </div>
        </div>

        <!-- - - - - - - - - - - - Controls / Setup - - - - - - - - - - - -->
        <div class="row">
          <div class="col-md-6 controls">
            <h3>Setup</h3>
            <div class="form-group">
              <label for="name-input">Please enter your name</label>
              <input id="name-input"type="text" ng-model="vm.playerName" placeholder="Name...">
              <div class="team-buttons-container">
                <button class="teamButton btn btn-default"
                        ng-class="{ disabled: (vm.currentGame == null) || 
                                              (vm.playerName.length < 1) ||
                                              vm.currentGame.gameInProgress ||
                                              (vm.currentGame.player1.length > 0),
                                    'picked-team': vm.playerTeam === 'x' }"
                        ng-click="vm.joinTeam('x')">
                        Play as X
                </button>
                <button class="teamButton btn btn-default" 
                        ng-class="{ disabled: vm.currentGame.gameInProgress || 
                                             (vm.playerName.length < 1) ||
                                             (vm.currentGame == null) ||
                                             (vm.currentGame.player2.length > 0),
                                    'picked-team': vm.playerTeam === 'o' }"
                        ng-click="vm.joinTeam('o')">
                        Play as O
                </button>
              </div>
              <div class="lobby-buttons-container">
                <button class="resetButton btn btn-default" ng-click="vm.addGame()">New Lobby</button>
                <button class="startGame btn btn-default" ng-click="vm.startGame()">Start game</button>
              </div>
              <button ng-show="vm.playerTeam !== ''" class="leave-team btn btn-default" ng-click="vm.leaveTeam()">Leave team</button>
            </div>
          </div>


          <!-- - - - - - - - - - - - Game info - - - - - - - - - - - -->
          <div class="col-md-6 game-status">
            <h3>Info</h3>
            <label>Players</label>
            <div class="player-status-container">
              <ul>
                <li><span class="info-x">X:</span>  <span class="info-x-name">{{ vm.currentGame.player1 | limitTo:13 }}</span></li>
                <li><span class="info-o">O:</span>  <span class="info-o-name">{{ vm.currentGame.player2 | limitTo:13 }}</span></li>
              </ul>
            </div>
            <label>Notifications</label>
            <div class="info-messages-container">
              <p ng-show="vm.currentGame.readyToStart">Ready to start!</p>
              <p ng-show="vm.currentGame.gameInProgress && vm.currentGame.turn">{{vm.currentGame.player1}}'s turn!</p>
              <p ng-show="vm.currentGame.gameInProgress && !vm.currentGame.turn">{{vm.currentGame.player2}}'s turn!</p>
            </div>
          </div>
        </div>

        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
        <!-- - - - - - - - - - - - GAME AREA - - - - - - - - - - - -->
        <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <div class="row">
          <div class="col-md-12 game-area-container">

            <!-- - - - - - - - - - - - Game board - - - - - - - - - - - -->
            <div class="board-container">
              <div class="board">
                <div class="board-row" ng-repeat="row in vm.currentGame.rows">
                  <div  class="board-square crossed" 
                        ng-repeat="square in row" 
                        ng-click="vm.currentGame.postGame || vm.clickSquare(square)" 
                        ng-class="{playerOne: vm.currentGame.turn, playerTwo: !vm.currentGame.turn, filled: square.filled, xMark: square.val === 'x', oMark: square.val === 'o', disabled: vm.currentGame.postGame, winner: square.winner }">
                      {{ square.val }}
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- - - - - - - - - - - - Win Message - - - - - - - - - - - -->
        <div class="row">
          <div class="col-md-12">
            <div class="win-message" ng-show="vm.currentGame.postGame">
              <p>{{ vm.currentGame.winner }}</p>
            </div>

            <div class="clear"></div>
          </div>
        </div>
      </div>
    </div>
  </div>


</body>
</html>