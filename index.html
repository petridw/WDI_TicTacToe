<!DOCTYPE html>
<html>
<head>
  <!-- fonts -->
  <link href='http://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Nunito' rel='stylesheet' type='text/css'>

  <!-- firebase and angular -->
  <script src='https://cdn.firebase.com/js/client/2.0.4/firebase.js'></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>

  <!--angular fire (must be last) -->
  <script src="https://cdn.firebase.com/libs/angularfire/0.9.0/angularfire.min.js"></script>
  
  <!-- my stylesheets -->
  <link rel="stylesheet" type="text/css" href="css/normalize.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" type="text/css" href="css/animations.css">

<!--   <script src="js/app.js"></script>-->
  <script src="js/GameController.js"></script>

  <title>whaaaaaaat</title>
</head>
<body ng-app="ticTacToeApp">
  <header>
    <h1>tic tac whaaat</h1>
  </header>

  <div class="game" ng-controller="GameController as vm">

    <!-- - - - - - - - - - - - Controls / Setup - - - - - - - - - - - -->
    <div class="sidebar controls">
      <h3>Setup</h3>
      <input type="text" ng-model="vm.playerName" placeholder="Name...">
      <button class="teamButton"
              ng-class="{ disabled: (vm.currentGame == null) || 
                                    (vm.playerName.length < 1) ||
                                    vm.currentGame.gameInProgress ||
                                    (vm.currentGame.player1.length > 0),
                          'picked-team': vm.playerTeam === 'x' }"
              ng-click="vm.joinTeam('x')">
              Join as X
      </button>
      <button class="teamButton" 
              ng-class="{ disabled: vm.currentGame.gameInProgress || 
                                   (vm.playerName.length < 1) ||
                                   (vm.currentGame == null) ||
                                   (vm.currentGame.player2.length > 0),
                          'picked-team': vm.playerTeam === 'o' }"
              ng-click="vm.joinTeam('o')">
              Join as O
      </button>
      <button class="resetButton" ng-click="vm.addGame()">New Lobby</button>
      <button class="startGame" ng-click="vm.startGame()">Start game</button>
    </div>

    <!-- - - - - - - - - - - - Lobbies - - - - - - - - - - - -->
    <div class="sidebar lobbies">
      <h3>Lobbies</h3>
      <div class="lobby-search">
        <input type="text" ng-model="vm.lobbySearch" placeholder="Search lobbies...">
      </div>
      <ul>
        <li ng-repeat="game in vm.games | orderBy:'time':true | filter:vm.lobbySearch | limitTo:10 ">
          <div class="lobby">
            <span class="game-time">{{ game.time | date:'short' }}</span>

            <a href="#" ng-click="vm.setCurrentGame(game.$id)"><span class="link"></span></a>

            <span ng-show="!game.postGame && !game.gameInProgress">Game not started...</span>
            <span ng-show="game.gameInProgress">
              {{ game.player1 }} vs. {{ game.player2 }}
            </span>
            <span ng-show="game.postGame">{{ game.winner }}</span>

          </div>
        </li>
      </ul>
      <div class="nav-buttons">
        <button class="nav-button arrow-back"></button>
        <button class="nav-button arrow-forward"></button>
      </div>
    </div>

    <!-- - - - - - - - - - - - Vs Text - - - - - - - - - - - -->
    <div class="vs-text">
      <p ng-show="vm.currentGame.readyToStart">{{ vm.currentGame.player1 }} vs {{ vm.currentGame.player2 }}</p>
    </div>

    <!-- - - - - - - - - - - - Messages - - - - - - - - - - - -->
    <div class="sidebar messages">
      <h3>Messages</h3>
      <form class="message-form">
        <input type="text" ng-model="vm.newMessage" placeholder="Send a message...">
        <button type="submit" ng-class="{ disabled: ((vm.playerName.length < 1) ||
                                                     (vm.newMessage.length < 1)) }"
                              ng-click="vm.sendMessage()">
          =>
        </button>
      </form>
      <ul class="message-list" ng-show="(vm.currentGame.messages.length > 0)">
        <li ng-repeat="message in vm.currentGame.messages | limitTo:20">
          <span ng-show="message.content.length > 0">{{ message.name }}: {{ message.content }}</span>
        </li>
      </ul>
    </div>

    <!-- - - - - - - - - - - - Current Game - - - - - - - - - - - -->


    <!-- - - - - - - - - - - - Game board - - - - - - - - - - - -->
    <div class="board">
      <div class="row" ng-repeat="row in vm.currentGame.rows">
        <div  class="square crossed" 
              ng-repeat="square in row" 
              ng-click="vm.currentGame.postGame || vm.clickSquare(square)" 
              ng-class="{playerOne: vm.currentGame.turn, playerTwo: !vm.currentGame.turn, filled: square.filled, xMark: square.val === 'x', oMark: square.val === 'o', disabled: vm.currentGame.postGame, winner: square.winner }">
            {{ square.val }}
        </div>
      </div>
    </div>

    <!-- - - - - - - - - - - - Win Message - - - - - - - - - - - -->
    <div class="win-message" ng-show="vm.currentGame.postGame">
      <p>{{ vm.currentGame.winner }}</p>
    </div>

    <div class="clear"></div>

    </div>


</body>
</html>